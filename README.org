[[buckets.jpg]]

These cats all have buckets.  Where's your bucket?

=bucket= is like a clipboard manager for the shell.  Or it's like Emacs/Vim-style registers for the shell.  It makes it easy to save clips of text to named "buckets" (or a default, unnamed bucket) and access them later.

** Examples
Pour into default bucket by argument:
#+BEGIN_SRC sh
$ bucket "I wondered why the frisbee was getting bigger, and then it hit me"
#+END_SRC

Pour from default bucket:
#+BEGIN_SRC sh
$ bucket
I wondered why the frisbee was getting bigger, and then it hit me
#+END_SRC

Pipe default bucket into named bucket:
#+BEGIN_SRC sh
$ bucket | bucket jokes
#+END_SRC

Pipe into named bucket, verbosely:
#+BEGIN_SRC sh
$ dmesg | grep error | bucket -v errors
[    7.817768] EXT4-fs (sdc1): re-mounted. Opts: errors=remount-ro,user_xattr
#+END_SRC

Pour from named bucket:
#+BEGIN_SRC sh
$ bucket errors
[    7.817768] EXT4-fs (sdc1): re-mounted. Opts: errors=remount-ro,user_xattr
#+END_SRC

Append to a bucket by argument:
#+BEGIN_SRC sh
$ bucket -a jokes "A plateau is the highest form of flattery."
$ bucket jokes
I wondered why the frisbee was getting bigger, and then it hit me
A plateau is the highest form of flattery. 
#+END_SRC

List buckets:
#+BEGIN_SRC sh
$ bucket -l
bucket  errors  jokes
#+END_SRC

List buckets verbosely (just the first line of each bucket):
#+BEGIN_SRC sh
$ bucket -lv
bucket: I wondered why the frisbee was getting bigger, and then it hit me
errors: [    7.817768] EXT4-fs (sdc1): re-mounted. Opts: errors=remount-ro,user_xattr
jokes: I wondered why the frisbee was getting bigger, and then it hit me
#+END_SRC

List buckets completely:
#+BEGIN_SRC sh
$ bucket -lV
bucket:
I wondered why the frisbee was getting bigger, and then it hit me

errors: 
[    7.817768] EXT4-fs (sdc1): re-mounted. Opts: errors=remount-ro,user_xattr

jokes:
I wondered why the frisbee was getting bigger, and then it hit me
A plateau is the highest form of flattery. 
#+END_SRC

Grep buckets:
#+BEGIN_SRC sh
$ bucket -g frisbee
bucket:I wondered why the frisbee was getting bigger, and then it hit me
jokes:I wondered why the frisbee was getting bigger, and then it hit me
#+END_SRC

Edit buckets (using =$EDITOR=):
#+BEGIN_SRC sh
$ bucket -e
Waiting for Emacs...
$ bucket -e jokes
Waiting for Emacs...
#+END_SRC

Empty buckets:
#+BEGIN_SRC sh
$ bucket -E
$ bucket
$ bucket -E jokes
$ bucket jokes
#+END_SRC

Expire old buckets:
#+BEGIN_SRC sh
$ sleep 14d  # Default: 2 weeks
$ bucket -x
$ bucket -l
#+END_SRC

And, of course, you can always:
#+BEGIN_SRC sh
$ bucket <(echo '
                  ___
   ___======____=---=)
 /T            \_--===)
 [ \ (0)   \~    \_-==)
  \      / )J~~    \-=)
   \\\\___/  )JJ~~~   \)
    \_____/JJ~~~~~    \\
    / \  , \J~~~~~     \\
   (-\)\=|\\\\\~~~~       L__
   (\\\\)  (\\\\\)_           \==__
    \V    \\\\\) ===_____   \\\\\\\\\\\\
           \V)     \_) \\\\\\\\JJ\J\)
                       /J\JT\JJJJ)
                       (JJJ| \UUU)
                        (UU)')
$ bucket | cat
*purr*

# or
$ make cheezburger | bucket
$ bucket | cat
                 .-.   _                __
                `  )`'-,`\        .-''``.-'
   _.-''-.      _.'       `'--._.' ,-'  /
   `\    _`'--'`                      .'
     '._ _`-       .--.   .--.      (`
        `.'       /    '.'    \      '.
       .'         \  0  |  0  /        '.
      /   _        '._.---._.'      _    \
      /    `'-.      (     )    .-'`     \
      / .---'_.   .   `-,-`  .  ._'---.  \
      |   -'`   .       |      .  `'-    |
      /_       .   '   /;\  '    .     ,_\
        '-.     '-..-`( ' )`-..-'     /
           '._         '-'         _.'
              '-..,__       __,..-'
                     `'---'`
#+END_SRC

** Usage
Yes, you can haz usage.

#+BEGIN_SRC
Usage:
    command | bucket [OPTIONS] [BUCKET]
    bucket [OPTIONS] [BUCKET] [DATA]

The first form reads data from STDIN and writes to the default bucket,
or BUCKET if given.  The second form reads DATA and/or BUCKET from
arguments, writing to a bucket or printing a bucket's contents.

Options:
    -a, --append   Append to bucket
    -d, --date     Sort by date
    -e, --edit     Edit bucket
    -E, --empty    Empty bucket
    -g, --grep     Grep in buckets
    -h, --help     I can haz cheezburger?
    -l, --list     List buckets
    -v, --verbose  Verbose output
    -V, --VERBOSE  VERY verbose output
    -x, --expire   eXpire old buckets (default: +14 days)
#+END_SRC

** Files
=bucket= is provided as both a Bash and a Fish script.  They work identically (or else it's a bug!).  But Fish makes more sense, because how could you put a bash in a bucket?  But Bash is faster, because how fast is a goldfish, really?

~bucket.completions.fish~ can be added your Fish session using the ~source~ command, and then Fish will provide =TAB= auto-completion for options and bucket names.

** Notes
+ The Fish version uses ~getopts.fish~, which is not yet part of the standard Fish distribution, so it's included here for convenience.  Just drop it into =~/.config/fish/functions=.  (And check it out!  It works really well and is well-documented.)
+ The default command for =expire= and =empty= is =trash-put=, part of the =trash-cli= package,which may not be installed on your system by default.  You can easily change the default to =rm= by changing the =deleteCommand= variable near the top of the script.  But =trash-cli= is a great package, so I recommend installing it.  It uses the standard XDG trash bin from the terminal.
    - Or you could change it to something like ~mv -t ~/.local/share/Trash/files~, although that might cause the trashed files to not show up in GUI trash apps, since they would be missing the ~.trashinfo~ files.

** Aliases
:PROPERTIES:
:ID:       fa457145-d56c-4674-95c1-b1f162758730
:END:
If you like to think in terms of registers, you might like to alias ~bucket~ to something like ~r~ so you can do:

#+BEGIN_SRC sh
$ alias r bucket
$ rgrep funny /usr/share/games/fortunes | r jokes
$ r jokes
...
people:We all know that no one understands anything that is not funny.
...

$ alias rl "bucket -l"
$ rl
jokes
#+END_SRC

Or you might like to use:

#+BEGIN_SRC sh
$ alias buckets "bucket -l"
$ buckets
jokes
#+END_SRC

If you like to keep a to-do list, you might find this handy:

#+BEGIN_SRC sh
$ alias rt "bucket today"
$ alias rta "'bucket -a today"
$ rta Walk the cat
$ rt
Walk the cat
$ rta Feed the cat
$ rt
Walk the cat
Feed the cat
$ cat --walk --feed
MEOW!
*purr*
$ rt -E
$ rt
$
#+END_SRC

** Development
I can't think of much else to add right now.  But I welcome suggestions and pull requests.  Bug reports may be kept to yourself (just kidding).

** License
I really don't think a license is necessary for something this straightfoward.  But consider it GPL'ed.
